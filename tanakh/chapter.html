<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>Chapter</title>
<link href="/israelite-research/styles.css" rel="stylesheet"/>
<style>
  :root{--ink:#0b2340;--accent:#F17300;--brand:#054A91;--muted:#6b7280;--sky:#DBE4EE;--white:#fff}
  .container{max-width:1200px;margin:0 auto;padding:0 16px}
  .page-header{padding:24px 0 8px}
  .page-title{margin:0;font-size:2rem;font-weight:800;color:var(--ink)}
  .crumbs{color:var(--muted);font-size:.9rem;margin-top:4px}
  .layout{display:grid;grid-template-columns:2fr 1fr;gap:18px;margin:16px 0 40px}
  .panel{background:var(--white);border:1px solid var(--sky);border-radius:10px;padding:14px}
  .panel h3{margin:.2rem 0 0.6rem;font-size:1.05rem;color:var(--brand)}
  .muted{color:var(--muted)}
  .vnum{min-width:26px;text-align:right;color:var(--muted)}
  .vtext{color:#111;line-height:1.5}
  .verse{display:flex; flex-direction:column; gap:.35rem; margin:.55rem 0; padding:.35rem .1rem; border-bottom:1px dashed var(--sky)}
  .vline{display:flex; gap:.6rem}
  .v-toolbar{display:flex; gap:.4rem; padding-left:36px}
  .v-toolbar button{border:1px solid #e6ebf2; background:#fff; border-radius:8px; padding:.22rem .5rem; font-size:.82rem; cursor:pointer}
  .v-toolbar button:hover{ background:#f8fafc }
  @media (max-width:900px){.layout{grid-template-columns:1fr}}

  .reader-toolbar{
    position: sticky; top: 0; z-index: 50;
    display:flex; align-items:center; justify-content:center; gap:.75rem;
    background:#fff; border:1px solid var(--sky); border-radius:10px;
    padding:.5rem; margin:10px 0 16px; box-shadow:0 1px 6px rgba(0,0,0,.05);
  }
  .reader-toolbar .btn{padding:.45rem .7rem; border:1px solid #e6ebf2; background:#fff; border-radius:10px; cursor:pointer; font:inherit;}
  .reader-toolbar .btn:hover{ background:#f8fafc }
  .reader-toolbar .ch-picker select{border:1px solid #e6ebf2; border-radius:10px; padding:.45rem .6rem; font:inherit;}
</style>
</head>
<body>
<div id="site-header"></div>
<main class="container">
  <div class="reader-toolbar" id="readerToolbar" role="navigation">
    <button class="btn prev" id="btnPrev" aria-label="Previous chapter">← Prev</button>
    <div class="ch-picker">
      <label class="sr-only" for="chSelect">Select chapter</label>
      <select id="chSelect"></select>
    </div>
    <button class="btn next" id="btnNext" aria-label="Next chapter">Next →</button>
  </div>

  <section class="layout">
    <div class="panel">
      <h3 id="bookHead">Text</h3>
      <div id="verses"><p class="muted">Loading…</p></div>
    </div>
    <aside class="panel" id="dictAside">
      <h3>Zondervan Compact Bible Dictionary</h3>
      <div style="display:flex; gap:.5rem; align-items:center; margin-bottom:.5rem">
        <input id="dictSearch" placeholder="Search term (e.g., Eden, Covenant)…"
               style="flex:1; border:1px solid #DBE4EE; border-radius:10px; padding:.5rem .6rem" type="search"/>
      </div>
      <div id="dictPanel"><p class="muted">Add <code>data/dictionaries/zondervan.json</code> to enable offline lookups.</p></div>
    </aside>
  </section>
</main>

<div id="site-footer"></div>
<script src="/israelite-research/js/include.js"></script>

<script>
/* Parse params and default to ch=1 if missing */
const qs = new URLSearchParams(location.search);
const book = (qs.get('book') || '').toLowerCase();
let ch = parseInt(qs.get('ch') || '1', 10);
if(!book){ document.getElementById('verses').innerHTML = '<p class="muted">No book specified.</p>'; }

/* Optional: total map for better prev/next disabling (fill as you like) */
const TOTALS = {
  // Tanakh example
  genesis:50, exodus:40, leviticus:27, numbers:36, deuteronomy:34,
  // NT example (complete if desired)
  'matthew':28,'mark':16,'luke':24,'john':21,'acts':28,'romans':16,
  'i-corinthians':16,'ii-corinthians':13,'galatians':6,'ephesians':6,
  'philippians':4,'colossians':4,'i-thessalonians':5,'ii-thessalonians':3,
  'i-timothy':6,'ii-timothy':4,'titus':3,'philemon':1,'hebrews':13,
  'james':5,'i-peter':5,'ii-peter':3,'i-john':5,'ii-john':1,'iii-john':1,
  'jude':1,'revelation':22
};
const total = TOTALS[book] || 150; // fallback max so UI still works

/* Title + header */
document.title = (book ? book.replace(/-/g,' ').toUpperCase() : 'Chapter') + ' ' + ch + ' — Reader';
const head = document.getElementById('bookHead');
if(head && book){ head.textContent = book.replace(/-/g,' ') + ' ' + ch; }

/* Build chapter picker */
(function buildPicker(){
  const sel = document.getElementById('chSelect');
  if(!sel) return;
  sel.innerHTML = '';
  for(let i=1;i<=total;i++){
    const opt = document.createElement('option');
    opt.value = i; opt.textContent = i;
    if(i===ch) opt.selected = true;
    sel.appendChild(opt);
  }
  sel.addEventListener('change', ()=>{
    const n = parseInt(sel.value,10)||1;
    location.href = location.pathname + '?book=' + encodeURIComponent(book) + '&ch=' + n;
  });
})();

/* Prev/Next */
const prev = document.getElementById('btnPrev');
const next = document.getElementById('btnNext');
function go(chNum){
  location.href = location.pathname + '?book=' + encodeURIComponent(book) + '&ch=' + chNum;
}
if(prev){ prev.disabled = (ch<=1); prev.addEventListener('click', ()=> ch>1 && go(ch-1)); }
if(next){ next.disabled = (ch>=total); next.addEventListener('click', ()=> ch<total && go(ch+1)); }

/* Load verses (keep your existing loader if you have one) */
(function load(){
  // If you already have a loader (e.g., /israelite-research/js/nt-chapter.js), call it here.
  // Example minimal placeholder:
  const t = document.getElementById('verses');
  t.innerHTML = '<p class="muted">Connect your data loader here (JSON → verses)</p>';
})();
</script>
</body>
</html>
